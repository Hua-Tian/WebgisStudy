function bindCompany(a){a.isAdmin?($("#leftmenu").prepend(a.data),setDefault()):($.data(document,"companyCd",a.companycd),$.data(document,"companyName",a.companyname),$.data(document,"defaultCircleSize",a.defaultvalue),$.data(document,"defaultOption",a.storedefault),$.data(document,"defaultCate",a.categorydefault),$.data(document,"defaultRange",a.rangedefault)),$("#area2").selectpicker({size:"7",maxOptions:"5",style:"btn-default btn-sm btn-sel",actionsBox:!0,container:"body",noneResultsText:messages["M-041"]}),$("#area3").selectpicker({size:"7",maxOptions:"5",style:"btn-default btn-sm btn-sel",actionsBox:!0,container:"body",noneResultsText:messages["M-042"]}),$("#area4").selectpicker({size:"7",maxOptions:"5",style:"btn-default btn-sm btn-sel",actionsBox:!0,container:"body",noneResultsText:messages["M-043"]}),$("#area2,#area3,#area4").siblings("button").attr("disabled",!0),$("#area2,#area3,#area4").attr("disabled",!0),bindArea("area1","00000000000"),get("mdates",{},Month.setData)}function setDefault(){var a=$("#company option:selected");$.data(document,"companyCd",a.val()),$.data(document,"companyName",a.text()),$.data(document,"defaultCircleSize",a.attr("defaultvalue")),$.data(document,"defaultOption",a.attr("storedefault")),$.data(document,"defaultCate",a.attr("categorydefault")),$.data(document,"defaultRange",a.attr("rangedefault"))}function bindArea(a,b){var c="";switch(a){case"area1":c="arealevel1";break;case"area2":c="arealevel2";break;case"area3":c="arealevel3";break;case"area4":c="arealevel4"}get("mranges",{arealevel:c,areacd:b},function(b){var c=$("#"+a);"area1"!=a&&"area4"!=a&&c.html($("<option value='0'>").text("-")),b.length>0&&($("#"+a).siblings("button").removeAttr("disabled"),$("#"+a).removeAttr("disabled"),Enumerable.From(b).Select(function(a){return $("<option x='"+a.x+"' y='"+a.y+"' value='"+a.a+"'>").text(a.b)[0]}).TojQuery().appendTo("#"+a),"area1"!=a&&c.selectpicker("refresh"))},{stopIfNull:!1})}function setTitle(){$("#title-month,#print-month").text($("#month"+$("input[name='monthtype']:checked").val()+" option:selected").text());var a="";$("#proportion")[0].checked?a="(率)":"",$("#less")[0].checked?a="(差)":"",$("#title-item,#print-item").text($("#option3 option:selected").text()+a),$("#print-age").text(Enumerable.From($("#age option:selected")).ToString(" ","$.text")),$("#print-area,#title-company").text(Enumerable.From($(".area-select option:selected")).ToString("  ","$.text")),$("#print-circle").text(Enumerable.From($(".maphead-left .label")).ToString(" / ","$.innerHTML"))}function setMapPara(){var b,c,d,e,f,g,h,a=$.data(document,"companyCd");$("#hidcompanycd").val(a),b=$("input:radio[name='monthtype']:checked").val(),$("#hiddatetype").val(b),0==b&&$(".monthcompare:checked").length>0?$("#hidmonthcompare").val(1):$("#hidmonthcompare").val(0),Option.defaultValue=$.data(document,"defaultRange"),$.data(document,"tempCompanyCd")!=a||$.data(document,"tempDateType")!=b||$.data(document,"tempMonthCompare")!=$("#hidmonthcompare").val()?($.data(document,"tempCompanyCd")!=a&&(class0Array=[],class1Array=[],classCompanyArray=[],cc()),$.data(document,"tempDateType",b),$.data(document,"tempMonthCompare",$("#hidmonthcompare").val()),get("moptions",{companycd:a,datetype:b},Option.setData,{async:!1}),$.data(document,"tempCompanyCd",a)):Option.fillData(0),c=$("#month"+$("input:radio[name='monthtype']:checked").val()).val(),d=0,e="000000",0==b&&($("#yesterday")[0].checked&&(d=2),$("#compare")[0].checked&&(d=4,e=$("#comparemonth").val())),$("#hidyearmonthcd").val(c),$("#hiddatecompare").val(d),$("#hidddatespare").val(e),$("#hidoption").val($("#option3").val()),$("#hidoptiontype").val($("#agescale").val()),$("#hidoptionscales").val(null==$("#age").val()?"0000":$("#age").val().join("_")),$("#hidarealevel").val($("#arealevel").val()),$.data(document,"yeaterday",$("#yesterday")[0].checked),$.data(document,"compare",$("#compare")[0].checked),f=$("select.area-select:not(:disabled):last option:selected"),g=f.attr("x"),h=f.attr("y"),$("#hidlng").val(g),$("#hidlat").val(h)}function getMapPara(){var a={datetype:$("#hiddatetype").val(),yearmonthcd:$("#hidyearmonthcd").val(),datecompare:$("#hiddatecompare").val(),datespare:$("#hidddatespare").val(),circletype:1,circlevalue:$.data(document,"defaultCircleSize"),option:$("#hidoption").val(),optiontype:$("#hidoptiontype").val(),optionscales:$("#hidoptionscales").val(),arealevel:$("#hidarealevel").val(),longitude:$("#hidlng").val(),latitude:$("#hidlat").val(),companycd:$("#hidcompanycd").val()};return"00"==a.optiontype&&(a.optionscales="0000"),a}function getLatlng(){var c,a=getMapPara(),b=$("#area4 option:selected");switch(a.arealvl){case"1":b=$("#area1 option:selected");break;case"2":b=$("#area2 option:selected");break;case"3":b=$("#area3 option:selected");break;case"4":b=$("#area4 option:selected")}return c={lat:parseFloat(b.attr("y")),lng:parseFloat(b.attr("x"))}}function getPlace(){var a=getMapPara();get("danalysis",{companycd:a.companycd,longitude:a.longitude,latitude:a.latitude},function(a){var c,d,b="";if(0==a.length)return $("#fxd").html("<p class='text-center' style='margin-top:15px;color:#fff;'>該当するデータがありません。</p>"),$("#place-list").show(),void 0;for(c=0;c<a.length;c++)d=a[c],b+='<div class="form-control-item fxd" comment="'+replaceHtml(d.g)+'" cd="'+d.a+'" x="'+d.d+'" y="'+d.e+'">',b+='<div class="fxd-title">',b+='<span class="fxd-name">'+replaceHtml(d.b)+"</span>",b+='<span class="fxd-user">'+replaceHtml(d.f)+"</span>",b+="</div>",b+='<p class="fxd-addr">'+replaceHtml(d.c)+"</p>",b+="</div>";$("#fxd").html(b),$("#place-list").show()},{stopIfNull:!1})}$("#leftmenu").on("change","#company",function(){setDefault(),$("input[name='monthtype'][value='0']").click(),$("#yesterday")[0].checked=!1,$("#yesterday").removeAttr("disabled"),$("#compare")[0].checked=!1,$("#comparemonth").hide(),$("#month0").find("option:first")[0].selected=!0,$("#month1").find("option:first")[0].selected=!0,$("#month2").find("option:first")[0].selected=!0,$("#area1 option:first")[0].selected=!0,$("#area1").change(),storeUploader.options.formData={companycd:$.data(document,"companyCd")}}),$("#age").selectpicker({size:"7",style:"btn-default btn-sm btn-sel"}),$("#btn-area").click(function(){window.location.href="area.html?from=newstore"}),$("#area1").change(function(){var a=$(this).val();$("#area2,#area3,#area4").empty(),$("#area2,#area3,#area4").siblings("button").children(".filter-option").text(""),$("#area2,#area3,#area4").siblings("button").attr("disabled",!0),$("#area2,#area3,#area4").attr("disabled",!0),0!=a&&bindArea("area2",a)}),$("#area2").change(function(){var a=$(this).val();$("#area3,#area4").empty(),$("#area3,#area4").siblings("button").children(".filter-option").text(""),$("#area3,#area4").siblings("button").attr("disabled",!0),$("#area3,#area4").attr("disabled",!0),0!=a&&bindArea("area3",a)}),$("#area3").change(function(){var a=$(this).val();$("#area4").empty(),$("#area4").siblings("button").children(".filter-option").text(""),$("#area4").siblings("button").attr("disabled",!0),$("#area4").attr("disabled",!0),0!=a&&bindArea("area4",a)}),$("#btnquery").click(function(){var a,b;return"0"==$("select.area-select:not(:disabled):last").val()?($.tremaps.showMessage("M-045"),void 0):(enableRight(),setMapPara(),a=$("select.area-select:not(:disabled):last"),b=a.find("option:selected"),storeArray=[{storetype:1,storecd:a.val(),storename:b.text(),latitude:parseFloat(b.attr("y")),longitude:parseFloat(b.attr("x"))}],storesCreate(3,0),setTitle(),$("#pac-input input").val(""),getPlace(),void 0)}),$("#option-query").click(function(){var a,b;return 0!=$("#agescale").val()&&null==$("#age").val()?($.tremaps.showMessage("M-048"),void 0):($("#hidoption").val($("#option3").val()),$("#hidoptiontype").val($("#agescale").val()),$("#hidoptionscales").val(null==$("#age").val()?"0000":$("#age").val().join("_")),$("#hidarealevel").val($("#arealevel").val()),a=getMapPara(),a.option=$("#option3").val(),$("#proportion")[0].checked&&($.data(document,"yeaterday")&&(a.datecompare=1),$.data(document,"compare")&&(a.datecompare=3)),$("#hiddatecompare").val(a.datecompare),reShow(3),b="",$("#proportion")[0].checked?b="(率)":"",$("#less")[0].checked?b="(差)":"",$("#title-item,#print-item").text($("#option3 option:selected").text()+b),$("#print-age").text(Enumerable.From($("#age option:selected")).ToString(" ","$.text")),void 0)}),$("#downexcel").click(function(){var b,a=getMapPara();return""==a.arealvl||$(this).hasClass("disabled")?($.tremaps.showMessage("M-004"),void 0):(b=$.tremaps.mapBusiness(),a.circletype=b.circletype,a.circlevalue=b.circlevalue,a["circlejyushos"]=b.circlejyushos,DownLoadFile({url:url+"excel/newstoremap",data:a}),void 0)}),$("#showlabel").click(function(){$(this)[0].checked?$.tremaps.showMapLabel():$.tremaps.hideMapLabel()}),$("#fxd").on("click",".fxd",function(){var a=parseFloat($(this).attr("x")),b=parseFloat($(this).attr("y"));storeArray=[{storetype:1,storecd:$(this).attr("cd"),storename:$(this).find(".fxd-name").text(),latitude:b,longitude:a,addr:$(this).find(".fxd-addr").text(),comment:$(this).attr("comment")}],setTitle(),setMapPara(),$("#hidlng").val(a),$("#hidlat").val(b),storesCreate(3,1),$("#print-area,#title-company").text($(this).find(".fxd-name").text())});