$.tremaps={mapCreate:function(a,b){var c=new google.maps.Map(a[0],{zoom:6,center:b,scaleControl:!0,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_BOTTOM},mapTypeControl:!0,streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_BOTTOM},mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE],position:google.maps.ControlPosition.RIGHT_BOTTOM}});return c},jsonPolygonsCreate:function(a,b){var e,c=Enumerable.From(a["points"]).Select("{lat:parseFloat($.lat),lng:parseFloat($.lng)}").ToArray(),d=new google.maps.Polygon({paths:c,strokeColor:"#333",strokeOpacity:.8,strokeWeight:.5,fillColor:"#FFFFFF",fillOpacity:.4,visible:!1,areacd:a["areacd"],level:-1,lnglat:a["lnglat"]});d.setMap(map),d.addListener("click",function(){var c,d,e;switch(b){case 1:$.tremaps.storeclick(this.areacd,this.lnglat);break;case 3:c=storeArray[0],d={lat:c["latitude"],lng:c["longitude"]},e=mapStoreArray[0],e.setPosition(d),$.tremaps.newstoreclick(this.areacd,this.lnglat)}}),3==b&&$.data(document,"auth")&&d.addListener("rightclick",competitorAdd),e=new MapLabel({text:a["areaname"],position:new google.maps.LatLng(a["lnglat"]),fontSize:10,zIndex:1e3,align:"center"}),d.mapLabel=e,mapRegionArray[a["areacd"]]=d},storeclick:function(a,b){var d,e,f,g,h,i,j,c='<div id="regionShow" class="panel panel-default"><div class="panel-title text-left">&nbsp;</div><div class="panel-body"><table class="table table-bordered"><thead><tr class="info"><th class="item">項目</th></tr></thead><tbody><tr><td>人口(人)</td></tr><tr><td>T会員(人)</td></tr><tr><td>T会員化率</td></tr><tr><td>あしあと利用者数(人)</td></tr><tr><td>全店利用者数(人)</td></tr><tr><td>自店利用者数(人)</td></tr><tr><td>自店利用率_対人口</td></tr><tr><td>自店利用率_対T会員</td></tr><tr><td>利用金額(円)</td></tr><tr><td>利用回数(回)</td></tr><tr><td>来店頻度(回)</td></tr><tr><td>客単価(円)</td></tr><tr><td>月間単価(円)</td></tr><tr><td>自店未利用者数(人)</td></tr><tr><td>全店未利用者数(人)</td></tr></tbody></table></div></div>';for(infowindow.setContent(c),infowindow.setPosition(b),infowindow.open(map),d=getMapPara(),d["areacd"]=a,e=[],f=0;f<mapRegionShowArray.length;f++)g=mapRegionShowArray[f],Enumerable.From(g["regions"]).Any("$.areacd=='"+a+"'")&&e.push(g["storecd"]);h=Enumerable.From(e).Distinct().ToString("_"),i="darea,",j={companycd:d["companycd"],storecds:h,datetype:d["datetype"],yearmonthcd:d["yearmonthcd"],arealevel:d["arealevel"],areacd:d["areacd"]},get(i+d["areacd"],j,function(a){var c,d,e;for($("#regionShow tbody tr"),c=a.length,d=0;c>d;d++)e=a[d],$("#regionShow .panel-title").text(e["d"]),$("#regionShow thead tr").append('<th style="min-width:80px;" class="text-right">'+e["b"]+"</th>"),$("#regionShow tbody tr:eq(0)").append('<td class="text-right">'+e["e"]+"</td>"),$("#regionShow tbody tr:eq(1)").append('<td class="text-right">'+e["f"]+"</td>"),$("#regionShow tbody tr:eq(2)").append('<td class="text-right">'+(100*e["g"]).toFixed(1)+"%</td>"),$("#regionShow tbody tr:eq(3)").append('<td class="text-right">'+e["h"]+"</td>"),$("#regionShow tbody tr:eq(4)").append('<td class="text-right">'+e["i"]+"</td>"),$("#regionShow tbody tr:eq(5)").append('<td class="text-right">'+e["j"]+"</td>"),$("#regionShow tbody tr:eq(6)").append('<td class="text-right">'+(100*e["k"]).toFixed(1)+"%</td>"),$("#regionShow tbody tr:eq(7)").append('<td class="text-right">'+(100*e["l"]).toFixed(1)+"%</td>"),$("#regionShow tbody tr:eq(8)").append('<td class="text-right">'+e["m"]+"</td>"),$("#regionShow tbody tr:eq(9)").append('<td class="text-right">'+e["n"]+"</td>"),$("#regionShow tbody tr:eq(10)").append('<td class="text-right">'+e["o"]+"</td>"),$("#regionShow tbody tr:eq(11)").append('<td class="text-right">'+e["p"]+"</td>"),$("#regionShow tbody tr:eq(12)").append('<td class="text-right">'+e["q"]+"</td>"),$("#regionShow tbody tr:eq(13)").append('<td class="text-right">'+e["r"]+"</td>"),$("#regionShow tbody tr:eq(14)").append('<td class="text-right">'+e["s"]+"</td>")})},newstoreclick:function(a,b){var d,e,f,c='<div role="tabpanel" id="pop-area" class="tab-pane active"><div style="border-bottom: 1px solid #CECECE;display:inline-block;word-break:break-all;word-wrap:break-word;height:auto;width:200px;font-weight:bold;"><span class="b"></span></div><p class="form-control-item"><label>人口(人)</label><span class="c"></span></p><p class="form-control-item"><label>T会員(人)</label><span class="d"></span></p><p class="form-control-item"><label>T会員化率</label><span class="e"></span></p><p class="form-control-item"><label>あしあと利用者数(人)</label><span class="f"></span></p><p class="form-control-item"><label>全店利用者数(人)</label><span class="g"></span></p><p class="form-control-item"><label>全店未利用者数(人)</label><span class="h"></span></p></div>';infowindow.setContent(c),infowindow.setPosition(b),infowindow.open(map),d=getMapPara(),d["areacd"]=a,e="dnewstorearea,",f={companycd:d["companycd"],datetype:d["datetype"],yearmonthcd:d["yearmonthcd"],arealevel:d["arealevel"],areacd:d["areacd"]},get(e+d["areacd"],f,function(a){$("#pop-area .b").text(a[0]["b"]),$("#pop-area .c").text(a[0]["c"]),$("#pop-area .d").text(a[0]["d"]),$("#pop-area .e").text((100*a[0]["e"]).toFixed(1)+"%"),$("#pop-area .f").text(a[0]["f"]),$("#pop-area .g").text(a[0]["g"]),$("#pop-area .h").text(a[0]["h"])})},storeCircleAreaCreate:function(a,b){var f,g,h,i,j,k,l,c=Enumerable.From(storeArray).Where("$.storecd=='"+a+"'").First(),d=Enumerable.From(levelArray).Select("value,index=>{level:index,range:value}").ToArray(),e=[];for(f=1==c["storetype"]?Enumerable.From(regionArray).Where("$.mindistance<="+1e3*b).ToArray():Enumerable.From(regionArray).Where("$.storecd=='"+a+"' &&　$.mindistance<="+1e3*b).ToArray(),g=0;g<f.length;g++)h=f[g],i=mapRegionArray[h["areacd"]],void 0!=i?(j=h["optionvalue"],d[0].range<=j?(k=Enumerable.From(d).Where("$.range<="+j).Last().level,i.level<=k&&(i.level=k,i.setOptions({fillColor:colorLevel[k]}))):(k=-1,i.level<=k&&i.setOptions({fillColor:"#FFFFFF"})),i.setVisible(!0),e.push(i)):console.log(h["areacd"]);mapRegionShowArray.push({storecd:a,areatype:1,arearange:b,mr:1e3*b,regions:e}),l=this.circleCreate({lat:c["latitude"],lng:c["longitude"]},b,"#F56954"),mapBusinessArray.push(l),circleTotals(1,b)},storeSaleAreaCreate:function(a){var f,g,h,i,j,k,l,b=Enumerable.From(storeArray).Where("$.storecd=='"+storecd+"'").First(),c=Enumerable.From(levelArray).Select("value,index=>{level:index,range:value}").ToArray(),d=0,e=[];for(f=1==b["storetype"]?Enumerable.From(regionArray).Where("$.sharerate<="+a).ToArray():Enumerable.From(regionArray).Where("$.storecd=='"+storecd+"' && $.sharerate<="+a).ToArray(),g=0;g<f.length;g++)h=f[g],(0==g||h["mindistance"]>d)&&(d=h["mindistance"]),i=mapRegionArray[h["areacd"]],void 0!=i?(j=h["optionvalue"],c[0].range<=j?(k=Enumerable.From(c).Where("$.range<="+j).Last().level,i.level<=k&&(i.level=k,i.setOptions({fillColor:colorLevel[k]}))):(k=-1,i.level<=k&&i.setOptions({fillColor:"#FFFFFF"})),i.setVisible(!0),e.push(i)):console.log(h["areacd"]);mapRegionShowArray.push({storecd:storecd,areatype:2,arearange:a,mr:d,regions:e}),l=this.circleCreate({lat:b["latitude"],lng:b["longitude"]},d/1e3,"#00a65a"),mapBusinessArray.push(l),circleTotals(2,a)},circleAreaCreate:function(a){var d,e,f,g,h,i,j,k,l,m,n,o,p,b=storeArray.length,c=Enumerable.From(levelArray).Select("value,index=>{level:index,range:value}").ToArray();for(d=0;b>d;d++){if(e=storeArray[d],f={lat:e["latitude"],lng:e["longitude"]},g=this.circleCreate(f,a,"#F56954"),mapBusinessArray.push(g),h=[],i=1==e["storetype"]?Enumerable.From(regionArray).Where("$.mindistance<="+1e3*a).ToArray():Enumerable.From(regionArray).Where("$.storecd=='"+e["storecd"]+"' &&　$.mindistance<="+1e3*a).ToArray(),j="0",0==i.length)for(k=0,1==e["storetype"]?(Enumerable.From(regionArray).Any()&&(k=Enumerable.From(regionArray).Min("$.mindistance")),i=Enumerable.From(regionArray).Where("$.mindistance=="+k).ToArray()):(Enumerable.From(regionArray).Where("$.storecd=='"+e["storecd"]+"'").Any()&&(k=Enumerable.From(regionArray).Where("$.storecd=='"+e["storecd"]+"'").Min("$.mindistance")),i=Enumerable.From(regionArray).Where("$.storecd=='"+e["storecd"]+"' && $.mindistance=="+k).ToArray()),l=0;l<i.length;l++)if(m=i[l],n=mapRegionArray[m["areacd"]],void 0!=n){if(google.maps.geometry.poly.containsLocation(new google.maps.LatLng(f),n)){i=[],i[0]=m,j=m["areacd"];break}}else console.log(m["areacd"]);for(l=0;l<i.length;l++)m=i[l],n=mapRegionArray[m["areacd"]],void 0!=n?(o=m["optionvalue"],c[0].range<=o?(p=Enumerable.From(c).Where("$.range<="+o).Last().level,n.level<=p&&(n.level=p,n.setOptions({fillColor:colorLevel[p]}))):(p=-1,n.level<=p&&n.setOptions({fillColor:"#FFFFFF"})),n.setVisible(!0),h.push(n)):console.log(m["areacd"]);mapRegionShowArray.push({storecd:e["storecd"],areatype:1,arearange:a,mr:1e3*a,regions:h,specialAreacd:j})}circleTotals(1,a)},saleAreaCreate:function(a){var d,e,f,g,h,i,j,k,l,m,n,b=storeArray.length,c=Enumerable.From(levelArray).Select("value,index=>{level:index,range:value}").ToArray();for(d=0;b>d;d++){for(e=storeArray[d],f=0,g=[],h=1==e["storetype"]?Enumerable.From(regionArray).Where("$.sharerate<="+a).ToArray():Enumerable.From(regionArray).Where("$.storecd=='"+e["storecd"]+"' && $.sharerate<="+a).ToArray(),i=0;i<h.length;i++)j=h[i],(0==i||j["mindistance"]>f)&&(f=j["mindistance"]),k=mapRegionArray[j["areacd"]],void 0!=k?(l=j["optionvalue"],c[0].range<=l?(m=Enumerable.From(c).Where("$.range<="+l).Last().level,k.level<=m&&(k.level=m,k.setOptions({fillColor:colorLevel[m]}))):(m=-1,k.level<=m&&k.setOptions({fillColor:"#FFFFFF"})),k.setVisible(!0),g.push(k)):console.log(j["areacd"]);mapRegionShowArray.push({storecd:e["storecd"],areatype:2,arearange:a,mr:f,regions:g}),n=this.circleCreate({lat:e["latitude"],lng:e["longitude"]},f/1e3,"#00a65a"),mapBusinessArray.push(n)}circleTotals(2,a)},polygonAreaCreate:function(a,b,c,d,e,f){var j,k,l,m,n,o,p,q,r,s,t,u,g=Enumerable.From(levelArray).Select("value,index=>{level:index,range:value}").ToArray(),h=d,i=Enumerable.From(storeArray).Where("$.storecd=='"+a+"' || '0'=='"+a+"'").ToArray();for(j=0;j<i.length;j++){if(k=[],l=i[j],m={lat:l["latitude"],lng:l["longitude"]},n=1==l["storetype"]?Enumerable.From(regionArray).Where("$.mindistance<="+f).ToArray():Enumerable.From(regionArray).Where("$.storecd=='"+l["storecd"]+"' && $.mindistance<="+f).ToArray(),0==n.length)for(o=0,1==l["storetype"]?(Enumerable.From(regionArray).Any()&&(o=Enumerable.From(regionArray).Min("$.mindistance")),n=Enumerable.From(regionArray).Where("$.mindistance=="+o).ToArray()):(Enumerable.From(regionArray).Where("$.storecd=='"+l["storecd"]+"'").Any()&&(o=Enumerable.From(regionArray).Where("$.storecd=='"+l["storecd"]+"'").Min("$.mindistance")),n=Enumerable.From(regionArray).Where("$.storecd=='"+l["storecd"]+"' && $.mindistance=="+o).ToArray()),p=0;p<n.length;p++)if(q=n[p],r=mapRegionArray[q["areacd"]],void 0!=r){if(google.maps.geometry.poly.containsLocation(new google.maps.LatLng(m),r)){n=[],n[0]=q,specialAreacd=q["areacd"];break}}else console.log(q["areacd"]);for(p=0;p<n.length;p++)q=n[p],s=mapRegionArray[q["areacd"]],void 0!=s?this.polygonsInterect(h,s)&&(t=q["optionvalue"],g[0].range<=t?(u=Enumerable.From(g).Where("$.range<="+t).Last().level,s.level<=u&&(s.level=u,s.setOptions({fillColor:colorLevel[u]}))):s.setOptions({fillColor:"#FFFFFF"}),s.setVisible(!0),k.push(s)):console.log(q["areacd"]);mapRegionShowArray.push({storecd:l["storecd"],areatype:b,arearange:c,mr:f,area:d,dashed:e,regions:k})}mapBusinessArray.push(e),e.setMap(map),circleTotals(b,c)},drawDashedCircle:function(a,b,c){var k,l,m,n,d=Math.PI/180,e=180/Math.PI,f=6371.393,g=128,h=b/f*e,i=h/Math.cos(a["lat"]*d),j=new Array;for(1==c?(k=0,l=g+1):(k=g+1,l=0),m=k;1==c?l>m:m>l;m+=c)n=Math.PI*(m/(g/2)),ey=a["lng"]+i*Math.cos(n),ex=a["lat"]+h*Math.sin(n),j.push(new google.maps.LatLng(ex,ey)),bounds.extend(j[j.length-1]);return j},drawPolygon:function(a){var c,d,b=new Array;for(c=0;c<a.length;c++)d=a[c],b.push(new google.maps.LatLng(d.lat,d.lng));return d=a[0],b.push(new google.maps.LatLng(d.lat,d.lng)),b},drawDashedPolygon:function(a,b){var e,c={path:"M 0,-1 0,1",strokeOpacity:1,scale:3},d=[];return $.merge(d,a),d.push(a[0]),e=new google.maps.Polyline({path:d,strokeOpacity:0,icons:[{icon:c,offset:"0",repeat:"12px"}],strokeWeight:3,zIndex:1e3,strokeColor:b})},circleCreate:function(a,b,c){var d,e;return bounds=new google.maps.LatLngBounds,d={path:"M 0,-1 0,1",strokeOpacity:1,scale:3},e=new google.maps.Polyline({path:this.drawDashedCircle(a,b,1),strokeOpacity:0,icons:[{icon:d,offset:"0",repeat:"12px"}],strokeWeight:2,strokeColor:c,fillColor:"#FF0000",fillOpacity:.35,zIndex:1e3,map:map}),map.fitBounds(bounds),e},circleSetRadius:function(a,b){for(var c=0;c<a.length;c++)a[c].setRadius(b)},businessAreaTotal:function(a,b){var c,d,e,f,h,i,j,k,l;for($(".businessarea").removeClass("open"),$(".businessarea").hide(),c=0;c<mapRegionShowArray.length;c++)d=$("#businessarea"+(c+1)),d.addClass("open");for(c=0;c<a.length;c++)e=a[c],$("#businessarea"+(c+1)+" thead th").text(e["circlename"]),$("#businessarea"+(c+1)+" tbody tr:eq(0) span").html(e["population"]),$("#businessarea"+(c+1)+" tbody tr:eq(1) span").html(e["tmember"]),$("#businessarea"+(c+1)+" tbody tr:eq(2) span").html((100*e["tmemberrate"]).toFixed(1)),$("#businessarea"+(c+1)+" tbody tr:eq(3) span").html(e["footprint"]),$("#businessarea"+(c+1)+" tbody tr:eq(4) span").html(e["userforallstore"]),0==b&&$("#businessarea"+(c+1)+" tbody tr:eq(5) span").html(e["userforstore"]);$(".businessarea.open").show(),f=$(window).height(),$(window).width(),h=$("#top").height(),i=$("#mapheader").height(),j=f-h-i,k=$(".businessarea:not(:hidden)"),l=0,k.each(function(){if(popWindowHeight=$(this).height()+20,j-l>popWindowHeight)0==l?($(this).attr("style","z-index: 0; position: absolute; top: "+(i+20)+"px; left: 10px; display: block"),$(this).addClass("popfirst")):$(this).attr("style","z-index: 0; position: absolute; top: "+popWindowHeight+"px; left: 10px; display: block"),l=popWindowHeight;else{var a=$(".popfirst").width()+20;$(this).attr("style","z-index: 0; position: absolute; top: "+(i+20)+"px; left: "+a+"px; display: block")}})},storesCreate:function(){var a,b,d,e,f,c=storeArray.length;for(d=0;c>d;d++)e=storeArray[d],(0==d||e["storecd"]<b)&&(minstoreid=e["storecd"],a={lat:e["latitude"],lng:e["longitude"]}),f=new google.maps.Marker({title:e["storename"],position:{lat:e["latitude"],lng:e["longitude"]},map:map}),1==c&&f.addListener("click",function(){0!=mapRegionShowArray.length&&($(".businessarea").is(":visible")?$(".businessarea").hide():$(".businessarea.open").show())}),mapStoreArray.push(f);map.setCenter(a)},redStoreCreate:function(){var a=storeArray[0],b=a["storename"],c=a["latitude"],d=a["longitude"],e={lat:c,lng:d},f=new google.maps.Marker({title:b,position:e,map:map,draggable:!0});f.addListener("click",function(){0!=mapRegionShowArray.length&&($(".businessarea").is(":visible")?$(".businessarea").hide():$(".businessarea.open").show())}),f.addListener("dragend",function(a){var b=this,c=a,d=c.latLng,f='<div role="tabpanel" class="tab-pane active" id="newstoremove" style="width:130px;margin-top:10px;"><p class="form-control-item">ここに移動しますか？</p><div><button class="btn btn-sm btn-default btncancle">キャンセル</button><button class="btn btn-sm btn-warning btnsure" style="float:right">確定</button></div></div>';infowindow.setContent(f),infowindow.setPosition(d),infowindow.open(map),$("#newstoremove .btnsure").click(function(){infowindow.open(null);var a=new google.maps.Geocoder;a.geocode({location:d},function(a,b){address=b===google.maps.GeocoderStatus.OK?a[1]?a[1].formatted_address:"No results found":"Geocoder failed due to: "+b,setMapPara(),storeArray=[{storetype:1,storecd:"0",storename:address,latitude:d.lat(),longitude:d.lng()}],$("#hidlng").val(d.lng()),$("#hidlat").val(d.lat()),setTitle(),storesCreate(3,0),$("#print-area,#title-company").text(address),$("#print-place").text(""),getPlace()})}),$("#newstoremove .btncancle").click(function(){b.setPosition(e),infowindow.open(null)}),infowindow.addListener("closeclick",function(){b.setPosition(e),infowindow.open(null)})}),mapStoreArray.push(f),map.setCenter(e)},blueStoreCreate:function(){var a=storeArray[0],b=a["storecd"],c=a["storename"],d=a["comment"],e=a["latitude"],f=a["longitude"],g={lat:e,lng:f},h=a["addr"],i=new google.maps.Marker({title:c,position:g,icon:"img/bluedot.png",map:map,storecd:b,storename:c,comment:d,address:h,lat:e,lng:f});i.addListener("click",function(){0!=mapRegionShowArray.length&&($(".businessarea").is(":visible")?$(".businessarea").hide():$(".businessarea.open").show())}),i.addListener("rightclick",function(){var b=this,c='<div role="tabpanel" class="tab-pane active" cd='+b.storecd+' id="map-editstore">'+'<p style="border-bottom: 1px solid #CECECE;">'+"<label>分析地編集</label>"+"</p>"+'<p class="form-control-item">'+"<label>分析地名</label>"+'<input type="text" class="form-control input-sm addressnm" maxlength="30"></input>'+"</p>"+'<p class="form-control-item">'+"<label>備考</label>"+'<input type="text" class="form-control input-sm mark" maxlength="100"></input>'+"</p>"+'<p class="form-control-item">'+'<div style="width:220px;margin-left:5px;" class="address">'+b.address+"</div>"+"</p>"+'<p class="form-control-item" style="border-bottom: 1px solid #CECECE;">'+'<span><b>経</b>：<span class="lng">'+b.lng+"</span></span>"+'<span style="float:right;"><b>緯</b>：<span class="lat">'+b.lat+"</span></span></p>"+'<p class="form-control-item text-right">'+'<button class="btn btn-sm btn-default btncancle">キャンセル</button>'+'<button class="btn btn-sm btn-default btndelete">削除</button>'+'<button class="btn btn-sm btn-warning btnsave">登録</button>'+"</p>"+"</div>";infowindow.setContent(c),infowindow.setPosition({lat:b.lat,lng:b.lng}),infowindow.open(map),$("#map-editstore .addressnm").val(b.storename),$("#map-editstore .mark").val(b.comment),$("#map-editstore .btnsave").click(function(){var h,a=$("#map-editstore").attr("cd"),c=$.trim($("#map-editstore .addressnm").val()),d=$.trim($("#map-editstore .mark").val()),e=$("#map-editstore .address").text(),f=$("#map-editstore .lng").text(),g=$("#map-editstore .lat").text();return""==c?($.tremaps.showMessage("M-046"),void 0):(h={updateflg:"UPDATE",addresscd:a,companycd:getMapPara().companycd,addressnm:c,comment:d,address:e,longitude:f,latitude:g},put("eanalysis,"+a,h,function(a){getPlace(),$.tremaps.showMessage("M-037"),b.setTitle(c),b.storename=c,b.comment=d,$("#print-place,#title-company").text(c),infowindow.open(null)}),void 0)}),$("#map-editstore .btndelete").click(function(){var a=$("#map-editstore").attr("cd"),b=$("#map-editstore .addressnm").val(),c=$.trim($("#map-editstore .mark").val()),d=$("#map-editstore .address").text(),e=$("#map-editstore .lng").text(),f=$("#map-editstore .lat").text(),g={updateflg:"DELETE",addresscd:a,companycd:getMapPara().companycd,addressnm:b,comment:c,address:d,longitude:e,latitude:f};put("eanalysis,"+a,g,function(b){if($.tremaps.showMessage("M-039"),lineArea.setPath([]),linePath=[],freeBusinessArea.setMap(null),$.tremaps.mapStoreClear(),$.tremaps.mapBusinessClear(),$.tremaps.mapRegionHide(),mapRegionShowArray=[],$("#mapheader,#save-widget,.businessarea").hide(),$("#pac-input").removeClass("state1"),$("#pac-input").addClass("state0"),$(".fxd[cd='"+a+"']").remove(),0==$(".fxd").length){var d='<p class="text-center" style="margin-top:15px;color:#fff;">該当するデータがありません。</p>';$("#fxd").append(d)}$("#print-place,#title-month,#title-item,#title-company").text(""),infowindow.open(null)})}),$("#map-editstore .btncancle").click(function(){infowindow.open(null)})}),mapStoreArray.push(i),map.setCenter(g)},competitorCreate:function(a){var d,e,f,b={url:"img/bluedot.png",size:new google.maps.Size(27,27)},c=[];for(d=0;d<a.length;d++)e=a[d],b["url"]="logo/"+e["e"],f=new google.maps.Marker({title:e["b"],position:{lat:e["y"],lng:e["x"]},icon:b,map:map}),c.push(f);return c},segmentsIntr:function(a,b,c,d){var g,h,e=(a.lng()-c.lng())*(b.lat()-c.lat())-(a.lat()-c.lat())*(b.lng()-c.lng()),f=(a.lng()-d.lng())*(b.lat()-d.lat())-(a.lat()-d.lat())*(b.lng()-d.lng());return e*f>0?!1:(g=(c.lng()-a.lng())*(d.lat()-a.lat())-(c.lat()-a.lat())*(d.lng()-a.lng()),h=g+e-f,g*h>0?!1:!0)},pointpolygonInterect:function(a,b){var e,c=a.getPath();for(b.getPath(),e=0;e<c.length;e++)if(google.maps.geometry.poly.containsLocation(c.getAt(e),b))return!0;return!1},polygonsInterect:function(a,b){var c,d,e,f,g,h,i,j,k,l;if(this.pointpolygonInterect(b,a))return!0;if(this.pointpolygonInterect(a,b))return!0;c=a.getPath(),d=b.getPath(),e=c.getLength(),f=d.getLength();a:for(g=0;e>g;g++)for(h=0;f>h;h++)if(i=c.getAt(g),j=e-1>g?c.getAt(g+1):c.getAt(0),k=d.getAt(h),l=f-1>h?d.getAt(h+1):d.getAt(0),this.segmentsIntr(i,j,k,l))break a},clearListeners:function(a){for(var b=0;b<a.length;b++)google.maps.event.clearInstanceListeners(a[b])},addListeners:function(a,b){for(var c=0;c<a.length;c++)google.maps.event.addListener(a[c],"click",b)},mapRegionHide:function(){var a,b,c,d;for(a=0;a<mapRegionShowArray.length;a++)for(b=mapRegionShowArray[a]["regions"],c=0;c<b.length;c++)d=b[c],d.getVisible()&&d.setVisible(!1)},mapRegionShow:function(){var a,b,c,d;for(a=0;a<mapRegionShowArray.length;a++)for(b=mapRegionShowArray[a]["regions"],c=0;c<b.length;c++)d=b[c],d.getVisible()||d.setVisible(!0)},mapStoreClear:function(){$.each(mapStoreArray,function(){this.setMap(null)}),mapStoreArray=[]},mapRegionClear:function(){$.each(mapRegionArray,function(a,b){b.setMap(null)}),mapRegionArray={}},mapRegionInit:function(){$.each(mapRegionArray,function(a,b){b.getVisible(),b.level=-1,b.setVisible(!1)})},mapBusinessClear:function(){for(var a=0;a<mapBusinessArray.length;a++)mapBusinessArray[a].setMap(null);mapBusinessArray=[]},showMapLabel:function(){var a,b,c;for(a=0;a<mapRegionShowArray.length;a++)for(b=mapRegionShowArray[a]["regions"],c=0;c<b.length;c++)b[c].mapLabel.setMap(map)},hideMapLabel:function(){var a,b,c;for(a=0;a<mapRegionShowArray.length;a++)for(b=mapRegionShowArray[a]["regions"],c=0;c<b.length;c++)b[c].mapLabel.setMap(null)},showMessage:function(a){var b=a;void 0!=messages[a]&&(b=messages[a]),$.MessageBox({content:b,type:"information",animate:{open:"top",close:"top",speed:"500"},buttons:{confirm:{title:"確定",style:"continue"}},usekey:!0,timeout:{second:"5",screen:!0}})},mapBusiness:function(){var e,f,g,h,a=[],b=[],c=[],d=[];for($("#set").nextAll().each(function(){var d=$(this),e=parseInt(d.attr("areatype")),f=parseFloat(d.attr("range"));a.push({areatype:e,arearange:f}),b.push(e),c.push(f)}),e=[],storeArray=Enumerable.From(storeArray).OrderBy("$.storecd").ToArray(),f=0;f<storeArray.length;f++)g=storeArray[f],d=[],$.each(a,function(){var e,a=this.areatype,b=this.arearange,c=Enumerable.From(mapRegionShowArray).Where("$.storecd=='"+g["storecd"]+"' && $.areatype=="+a+" && $.arearange=="+b).First();switch(a){case 1:case 2:e=c["specialAreacd"],void 0!=e&&"0"!=e?d.push(e):d.push(0);break;case 3:case 4:case 5:case 6:d.push(Enumerable.From(c["regions"]).Select("$.areacd").ToString(","))}}),e.push(d.join("_"));return h={circletype:b.join("_"),circlevalue:c.join("_"),circlejyushos:e.join("-")}},sleep:function(a){for(var b=(new Date).getTime();;)if((new Date).getTime()-b>a)break},ajaxLoad:function(a,b){var c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");c.onreadystatechange=b,c.open("GET",a),c.send(null)},pointInPolygon:function(a,b){var c=a.lng,d=a.lat,e=b.getPath(),f=e.length,g=f-1,h=!1;for(i=0;f>i;i++)(e.getAt(i).lat()<d&&e.getAt(g).lat()>=d||e.getAt(g).lat()<d&&e.getAt(i).lat()>=d)&&(e.getAt(i).lng()<=c||e.getAt(g).lng()<=c)&&e.getAt(i).lng()+(d-e.getAt(i).lat())/(e.getAt(g).lat()-e.getAt(i).lat())*(e.getAt(g).lng()-e.getAt(i).lng())<c&&(h=!h),g=i;return h},ccInit:function(){$("#cooperations input").prop("checked",!1),$.each(mapCooperationArray,function(){this.setMap(null)}),$("#competitors input").prop("checked",!1),$.each(mapCompetitorArray,function(){this.setMap(null)}),class0Array=[],class1Array=[],classCompanyArray=[]}};